!function (t, e) { "object" == typeof exports && "undefined" != typeof module ? module.exports = e() : "function" == typeof define && define.amd ? define(e) : t.ES6Promise = e() }(this, function () { "use strict"; function a(t) { return "function" == typeof t } var r = Array.isArray ? Array.isArray : function (t) { return "[object Array]" === Object.prototype.toString.call(t) }, n = 0, e = void 0, o = void 0, u = function (t, e) { h[n] = t, h[n + 1] = e, 2 === (n += 2) && (o ? o(v) : m()) }; var t = "undefined" != typeof window ? window : void 0, i = t || {}, s = i.MutationObserver || i.WebKitMutationObserver, c = "undefined" == typeof self && "undefined" != typeof process && "[object process]" === {}.toString.call(process), f = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel; function l() { var t = setTimeout; return function () { return t(v, 1) } } var h = new Array(1e3); function v() { for (var t = 0; t < n; t += 2) { (0, h[t])(h[t + 1]), h[t] = void 0, h[t + 1] = void 0 } n = 0 } var p, d, _, y, m = void 0; function b(t, e) { var r = this, n = new this.constructor(A); void 0 === n[g] && N(n); var o = r._state; if (o) { var i = arguments[o - 1]; u(function () { return K(o, n, i, r._result) }) } else k(r, n, t, e); return n } function w(t) { if (t && "object" == typeof t && t.constructor === this) return t; var e = new this(A); return x(e, t), e } c ? m = function () { return process.nextTick(v) } : s ? (d = 0, _ = new s(v), y = document.createTextNode(""), _.observe(y, { characterData: !0 }), m = function () { y.data = d = ++d % 2 }) : f ? ((p = new MessageChannel).port1.onmessage = v, m = function () { return p.port2.postMessage(0) }) : m = void 0 === t && "function" == typeof require ? function () { try { var t = require("vertx"); return void 0 !== (e = t.runOnLoop || t.runOnContext) ? function () { e(v) } : l() } catch (t) { return l() } }() : l(); var g = Math.random().toString(36).substring(16); function A() { } var S = void 0, E = 1, j = 2, P = new F; function T(t) { try { return t.then } catch (t) { return P.error = t, P } } function M(t, e, r) { var n, o, i, s; e.constructor === t.constructor && r === b && e.constructor.resolve === w ? (i = t, (s = e)._state === E ? O(i, s._result) : s._state === j ? Y(i, s._result) : k(s, void 0, function (t) { return x(i, t) }, function (t) { return Y(i, t) })) : r === P ? (Y(t, P.error), P.error = null) : void 0 === r ? O(t, e) : a(r) ? (n = e, o = r, u(function (e) { var r = !1, t = function (t, e, r, n) { try { t.call(e, r, n) } catch (t) { return t } }(o, n, function (t) { r || (r = !0, n !== t ? x(e, t) : O(e, t)) }, function (t) { r || (r = !0, Y(e, t)) }, e._label); !r && t && (r = !0, Y(e, t)) }, t)) : O(t, e) } function x(t, e) { var r, n; t === e ? Y(t, new TypeError("You cannot resolve a promise with itself")) : (n = typeof (r = e), null === r || "object" !== n && "function" !== n ? O(t, e) : M(t, e, T(e))) } function C(t) { t._onerror && t._onerror(t._result), q(t) } function O(t, e) { t._state === S && (t._result = e, t._state = E, 0 !== t._subscribers.length && u(q, t)) } function Y(t, e) { t._state === S && (t._state = j, t._result = e, u(C, t)) } function k(t, e, r, n) { var o = t._subscribers, i = o.length; t._onerror = null, o[i] = e, o[i + E] = r, o[i + j] = n, 0 === i && t._state && u(q, t) } function q(t) { var e = t._subscribers, r = t._state; if (0 !== e.length) { for (var n = void 0, o = void 0, i = t._result, s = 0; s < e.length; s += 3)n = e[s], o = e[s + r], n ? K(r, n, o, i) : o(i); t._subscribers.length = 0 } } function F() { this.error = null } var D = new F; function K(t, e, r, n) { var o = a(r), i = void 0, s = void 0, u = void 0, c = void 0; if (o) { if ((i = function (t, e) { try { return t(e) } catch (t) { return D.error = t, D } }(r, n)) === D ? (c = !0, s = i.error, i.error = null) : u = !0, e === i) return void Y(e, new TypeError("A promises callback cannot return that same promise.")) } else i = n, u = !0; e._state !== S || (o && u ? x(e, i) : c ? Y(e, s) : t === E ? O(e, i) : t === j && Y(e, i)) } var L = 0; function N(t) { t[g] = L++ , t._state = void 0, t._result = void 0, t._subscribers = [] } var U = function () { function t(t, e) { this._instanceConstructor = t, this.promise = new t(A), this.promise[g] || N(this.promise), r(e) ? (this.length = e.length, this._remaining = e.length, this._result = new Array(this.length), 0 === this.length ? O(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(e), 0 === this._remaining && O(this.promise, this._result))) : Y(this.promise, new Error("Array Methods must be provided an Array")) } return t.prototype._enumerate = function (t) { for (var e = 0; this._state === S && e < t.length; e++)this._eachEntry(t[e], e) }, t.prototype._eachEntry = function (e, t) { var r = this._instanceConstructor, n = r.resolve; if (n === w) { var o = T(e); if (o === b && e._state !== S) this._settledAt(e._state, t, e._result); else if ("function" != typeof o) this._remaining-- , this._result[t] = e; else if (r === W) { var i = new r(A); M(i, e, o), this._willSettleAt(i, t) } else this._willSettleAt(new r(function (t) { return t(e) }), t) } else this._willSettleAt(n(e), t) }, t.prototype._settledAt = function (t, e, r) { var n = this.promise; n._state === S && (this._remaining-- , t === j ? Y(n, r) : this._result[e] = r), 0 === this._remaining && O(n, this._result) }, t.prototype._willSettleAt = function (t, e) { var r = this; k(t, void 0, function (t) { return r._settledAt(E, e, t) }, function (t) { return r._settledAt(j, e, t) }) }, t }(); var W = function () { function e(t) { this[g] = L++ , this._result = this._state = void 0, this._subscribers = [], A !== t && ("function" != typeof t && function () { throw new TypeError("You must pass a resolver function as the first argument to the promise constructor") }(), this instanceof e ? function (e, t) { try { t(function (t) { x(e, t) }, function (t) { Y(e, t) }) } catch (t) { Y(e, t) } }(this, t) : function () { throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.") }()) } return e.prototype.catch = function (t) { return this.then(null, t) }, e.prototype.finally = function (e) { var r = this.constructor; return this.then(function (t) { return r.resolve(e()).then(function () { return t }) }, function (t) { return r.resolve(e()).then(function () { throw t }) }) }, e }(); return W.prototype.then = b, W.all = function (t) { return new U(this, t).promise }, W.race = function (o) { var i = this; return r(o) ? new i(function (t, e) { for (var r = o.length, n = 0; n < r; n++)i.resolve(o[n]).then(t, e) }) : new i(function (t, e) { return e(new TypeError("You must pass an array to race.")) }) }, W.resolve = w, W.reject = function (t) { var e = new this(A); return Y(e, t), e }, W._setScheduler = function (t) { o = t }, W._setAsap = function (t) { u = t }, W._asap = u, W.polyfill = function () { var t = void 0; if ("undefined" != typeof global) t = global; else if ("undefined" != typeof self) t = self; else try { t = Function("return this")() } catch (t) { throw new Error("polyfill failed because global object is unavailable in this environment") } var e = t.Promise; if (e) { var r = null; try { r = Object.prototype.toString.call(e.resolve()) } catch (t) { } if ("[object Promise]" === r && !e.cast) return } t.Promise = W }, W.Promise = W }), ES6Promise.polyfill(), Promise = ES6Promise;